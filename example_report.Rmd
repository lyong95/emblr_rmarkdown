---
title: "Analysis of chemotherapy trial for colon cancer"
author: "Luoyan Yong"
date: "13/05/2021"
output: html_document
params: 
  age: 20
  data: "/g/typas/Personal_Folders/Luoyan/emblR/Rmarkdown/lung.csv"
---

```{r setup}
knitr::opts_chunk$set(echo = FALSE)
```

[Rmd cheatsheet][<https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf>]

```{r, include = FALSE}
#load packages
library(dplyr)
library(tidyverse)
library(survival)
library(survminer)
```

## Description of data

These are data from one of the *first* successful trials of adjuvant chemotherapy for colon cancer. There are two records per person, one for recurrence and one for death.

![info](/g/typas/Personal_Folders/Luoyan/emblR/Rmarkdown/info.png)

```{r, message = FALSE}
dat = read.csv(params$data)
head(dat)
```

The data set consisted of `r nrow(dat)` records. A summary of the data set is presented in the table below.

```{r}
summary(dat)
```

## Do females survive better than males?

```{r}
# compute kaplan-Meier survival estimate
fit <- survfit(Surv(time, status) ~ sex, data = dat)

# Change color, linetype by strata, risk.table color by strata
ggsurvplot(fit,
          pval = TRUE, conf.int = TRUE,
          surv.median.line = "hv", # Specify median survival
          palette = c("#E7B800", "#2E9FDF"))
```

The median survival time for sex=1 (Male group) is 2200 days, while it is 2500 days for sex=2 (Female).

## Do patients older than a specified age survive less? 
It is also interesting to find out if survival rates of treatment differ between patients with older than `r params$age`

```{r}
agegp = dat %>% filter(age > params$age)
ggsurvplot(survfit(Surv(time, status)~ sex, data = agegp))
```
