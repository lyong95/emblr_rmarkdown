---
title: "Analysis of chemotherapy trial for colon cancer dashboard"
output: flexdashboard::flex_dashboard
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```

```{r, include = FALSE}
#load packages
library(dplyr)
library(tidyverse)
library(survival)
library(survminer)
```

## Do females survive better than males?

```{r}
data(colon)
head(colon)
```

```{r}
# compute kaplan-Meier survival estimate
fit <- survfit(Surv(time, status) ~ sex, data = colon)

# Change color, linetype by strata, risk.table color by strata
ggsurvplot(fit,
          pval = TRUE, conf.int = TRUE,
          surv.median.line = "hv", # Specify median survival
          palette = c("#E7B800", "#2E9FDF"))
```

## Do patients with more than `r params$nodes_num`nodes detected with cancer survive less?
```{r}
colon_node = colon %>% filter(nodes > params$nodes_num)
ggsurvplot(survfit(Surv(time, status)~nodes, data=colon_node))
```
